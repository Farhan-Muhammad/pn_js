<p>The foundation of the PubNub service is the ability to send a message and have it delivered anywhere in less than 100ms. Send a message to just one other person, or broadcast to thousands of subscribers at once.</p><p>For higher-level conceptual details on publishing and subscribing, refer to <a href="/docs/platform/connections/connection-management">Connection Management</a> and to <a href="/docs/platform/messages/publish">Publish Messages</a>.</p><h2 class="inpage-link tag-link main-placeholder">Publish</h2><h3 class="inpage-link tag-link">Description</h3><p>The <code>publish()</code> function is used to send a message to all subscribers of a channel. To publish a message you must first specify a valid <code>publishKey</code> at initialization. A successfully published message is replicated across the PubNub Real-Time Network and sent simultaneously to all subscribed clients on a channel.</p><p>Messages in transit can be secured from potential eavesdroppers with SSL/TLS by setting ssl to true during initialization.</p><div class="title-heading"><b>Publish Anytime</b></div><p>It's not required to be subscribed to a channel in order to publish to that channel.</p><div class="title-heading"><b>Message Data:</b></div><p>The message argument can contain any JSON serializable data, including: Objects, Arrays, Ints and Strings. <code>data</code> should not contain special JavaScript V4 classes or functions as these will not serialize. String content can include any single-byte or multi-byte UTF-8 character.</p><table class="table-icon-warning"><tbody><tr><td class="icon"><i class="fa icon icon-warning" title="warning">&nbsp;</i></td><td><div class="title-heading">Don't Use JSON.stringify!</div><div>It is important to note that you should not use <code>JSON.stringify()</code> when sending signals/messages via PubNub. Why? Because the serialization is done for you automatically. Instead just pass the full object as the message payload. PubNub takes care of everything for you.</div></td></tr></tbody></table><div class="title-heading"><b>Message Size:</b></div><p>The maximum number of characters per message is 32 KiB by default. The maximum message size is based on the final escaped character count, including the channel name. An ideal message size is under 1800 bytes which allows a message to be compressed and sent using single IP datagram (1.5 KiB) providing optimal network performance.</p><p>If the message you publish exceeds the configured size, you will receive the following message:</p><div class="title-heading"><b>Message Too Large Error</b></div>

<p>For further details please check: <a class="word-break" href="https://support.pubnub.com/support/solutions/articles/14000113049-calculating-message-payload-size-before-publish" title="Calculating Message Payload Size Before Publish" target="_blank">https://support.pubnub.com/support/solutions/articles/14000113049-calculating-message-payload-size-before-publish</a>.</p><div class="title-heading"><b>Message Publish Rate:</b></div><p>Messages can be published as fast as bandwidth conditions will allow. There is a soft limit based on max throughput since messages will be discarded if the subscriber can't keep pace with the publisher.</p><p>For example, if 200 messages are published simultaneously before a subscriber has had a chance to receive any messages, the subscriber may not receive the first 100 messages because the message queue has a limit of only 100 messages stored in memory.</p><div class="title-heading"><b>Publishing to Multiple Channels:</b></div><p>It is not possible to publish a message to multiple channels simultaneously. The message must be published to one channel at a time.</p><div class="title-heading"><b>Publishing Messages Reliably:</b></div><p>There are some best practices to ensure messages are delivered when publishing to a channel:</p><ul><li>Publish to any given channel in a serial manner (not concurrently).</li><li>Check that the return code is success (e.g. <code>[1,"Sent","136074940..."]</code>)</li><li>Publish the next message only after receiving a success return code.</li><li>If a failure code is returned (<code>[0,"blah","&lt;timetoken&gt;"]</code>), retry the publish.</li><li>Avoid exceeding the in-memory queue's capacity of 100 messages. An overflow situation (aka missed messages) can occur if slow subscribers fail to keep up with the publish pace in a given period of time.</li><li>Throttle publish bursts in accordance with your app's latency needs e.g. Publish no faster than 5 msgs per second to any one channel.</li></ul><h3 class="inpage-link tag-link">Method(s)</h3><div>To <code>Publish a message</code> you can use the following method(s) in the JavaScript V4 SDK:</div><ol class="ol-margin-extra"><li class="list-inline"><div><code class="inpage-plink tag-link padding-left-0"> <a href="#publish_args_1" data-id="publish_args_1" title="Publish Argument" class="title-red" id="publish_args_1">publish(<br> <span class="margin-left-1">{Object <code>message</code>, String <code>channel</code>, Boolean <code>storeInHistory</code>, Boolean <code>sendByPost</code>, Object <code>meta</code>, Number <code>ttl</code> },</span> <span class="margin-left-1">Function <code>callback</code></span> ) </a></code></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th>Parameter</th><th>Type</th><th>Required</th><th>Defaults</th><th>Description</th></tr></thead><tbody><tr><td>Operation Arguments</td><td> Hash</td><td> Yes</td><td></td><td>A hash of arguments.</td></tr><tr><td><code class="margin-left-1">message </code></td><td>Object</td><td>Yes</td><td></td><td>The <code>message</code> may be any valid JSON type including objects, arrays, strings, and numbers.</td></tr><tr><td><code class="margin-left-1"> channel </code></td><td>String</td><td> Yes</td><td></td><td>Specifies <code>channel</code> name to publish messages to.</td></tr><tr><td><code class="margin-left-1"> storeInHistory </code></td><td> Boolean</td><td> Optional</td><td><code>true</code></td><td><p>If <code>true</code> the messages are stored in history.</p><p>If <code>storeInHistory</code> is not specified, then the history configuration on the key is used.</p></td></tr><tr><td><code class="margin-left-1">sendByPost </code></td><td> Boolean</td><td> Optional</td><td><code>false</code></td><td>When <code>true</code>, the SDK uses HTTP POST to publish the messages. The message is sent in the BODY of the request, instead of the query string when HTTP GET is used. Also the messages are compressed thus reducing the size of the messages. <br><br>Using HTTP POST to publish messages adheres to RESTful API best practices.</td></tr><tr><td><code class="margin-left-1">meta</code></td><td> Object</td><td> Optional</td><td></td><td>Publish extra <code>meta</code> with the request.</td></tr><tr><td><code class="margin-left-1">ttl</code></td><td>Number</td><td>Optional</td><td></td><td><div>Set a per message time to live in storage.</div><ol><li>If <code>storeInHistory</code> = <code>true</code>, and <code>ttl</code> = <code>0</code>, the message is stored with no expiry time.</li><li>If <code>storeInHistory</code> = <code>true</code> and <code>ttl</code> = <code>X</code> (<code>X</code> is an Integer value), the message is stored with an expiry time of <code>X</code> hours.</li><li>If <code>storeInHistory</code> = <code>false</code>, the <code>ttl</code> parameter is ignored.</li><li>If <code>ttl</code> is not specified, then expiration of the message defaults back to the expiry value for the key.</li></ol></td></tr><tr><td><code> callback </code></td><td>Function</td><td>Optional</td><td></td><td>Executes on a successful/unsuccessful <code>publish</code>.</td></tr></tbody></table></div></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li><li class="hidden"></li></ol><h3 class="inpage-link tag-link">Basic Usage</h3><h4>Publish a message to a channel:</h4>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token pn-variable pn-before-colon">such</span><span class="token operator">:</span> <span class="token string">'object'</span> 
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">sendByPost</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// true to send via post</span>
        <span class="token pn-variable pn-before-colon">storeInHistory</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//override default storage options</span>
        <span class="token pn-variable pn-before-colon">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token string">"cool"</span><span class="token operator">:</span> <span class="token string">"meta"</span>
        <span class="token punctuation">}</span>   <span class="token comment">// publish extra meta with the request</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// handle error</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"message Published w/ timetoken"</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<table class="table-icon-note"><tbody><tr><td class="icon"><i class="fa icon icon-note" title="note">&nbsp;</i></td><td><div>Before running the above publish example, either using the <a href="/docs/console?channel=hello_world&amp;origin=ps.pndsn.com&amp;sub=demo&amp;pub=demo&amp;cipher=&amp;ssl=false&amp;secret=&amp;auth=" title="Debug Console">Debug Console</a>, or in a separate script running in a separate terminal window, <a href="#subscribe">subscribe to the same channel</a> that is being published to.</div></td></tr></tbody></table><h3 class="inpage-link tag-link">Response</h3>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json">type PublishResponse = <span class="token punctuation">{</span>
    timetoken<span class="token operator">:</span> number
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<h3 class="inpage-link tag-link">Other Examples</h3><ol class="ol-margin-extra"><li><div class="inpage-plink tag-link"><a href="#publish-example-1" data-id="publish-example-1" title="Publish a JSON serialized message" class="title-red" id="publish-example-1">Publish a JSON serialized message</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword keyword-var">var</span> <span class="token pn-variable pn-before-equal">newMessage</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">text</span><span class="token operator">:</span> <span class="token string">'Hi There!'</span>
<span class="token punctuation">}</span>
<span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token pn-variable">newMessage</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"publishing failed w/ status: "</span><span class="token punctuation">,</span> <span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"message published w/ server response: "</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#store-published-message" data-id="store-published-message" title="Store the published message for 10 hours" class="title-red" id="store-published-message">Store the published message for 10 hours</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello!'</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">storeInHistory</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">ttl</span><span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"publishing failed w/ status: "</span><span class="token punctuation">,</span> <span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"message published w/ server response: "</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-successful" data-id="publish-successful" title="Publish successful" class="title-red" id="publish-successful">Publish successful</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {error: false, operation: "PNPublishOperation", statusCode: 200}</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {timetoken: "14920301569575101"}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-by-network-down" data-id="publish-unsuccessful-by-network-down" title="Publish unsuccessful by network down" class="title-red" id="publish-unsuccessful-by-network-down">Publish unsuccessful by network down</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {error: true, operation: "PNPublishOperation", errorData: Error, category: "PNNetworkIssuesCategory"}</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-without-publishkey" data-id="publish-unsuccessful-without-publishkey" title="Publish unsuccessful by initialization without publishKey" class="title-red" id="publish-unsuccessful-without-publishkey">Publish unsuccessful by initialization without publishKey</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span><span class="token punctuation">,</span> 
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {error: true, operation: "PNPublishOperation", statusCode: 400, errorData: Error, category: "PNBadRequestCategory"}</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-by-missing-channel" data-id="publish-unsuccessful-by-missing-channel" title="Publish unsuccessful by missing channel" class="title-red" id="publish-unsuccessful-by-missing-channel">Publish unsuccessful by missing channel</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> 
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {message: "Missing Channel", type: "validationError", error: true}</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-by-missing-message" data-id="publish-unsuccessful-by-missing-message" title="Publish unsuccessful by missing message" class="title-red" id="publish-unsuccessful-by-missing-message">Publish unsuccessful by missing message</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {message: "Missing Message", type: "validationError", error: true}</span>
        <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-basic-usage-using-promises" data-id="publish-basic-usage-using-promises" title="Basic usage using Promises" class="title-red" id="publish-basic-usage-using-promises">Basic usage using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token pn-variable pn-before-colon">such</span><span class="token operator">:</span> <span class="token string">'object'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">sendByPost</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// true to send via post</span>
    <span class="token pn-variable pn-before-colon">storeInHistory</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//override default storage options</span>
    <span class="token pn-variable pn-before-colon">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token string">"cool"</span><span class="token operator">:</span> <span class="token string">"meta"</span>
    <span class="token punctuation">}</span>   <span class="token comment">// publish extra meta with the request</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">error</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-json-using-promises" data-id="publish-json-using-promises" title="Publish a JSON serialized message using Promises" class="title-red" id="publish-json-using-promises">Publish a JSON serialized message using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword keyword-var">var</span> <span class="token pn-variable pn-before-equal">newMessage</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">text</span><span class="token operator">:</span> <span class="token string">'Hi There!'</span>
<span class="token punctuation">}</span>
<span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token pn-variable">newMessage</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">error</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#store-published-message-using-promises" data-id="store-published-message-using-promises" title="Store the published message for 10 hours using Promises" class="title-red" id="store-published-message-using-promises">Store the published message for 10 hours using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello!'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">storeInHistory</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">ttl</span><span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">error</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-successful-using-promises" data-id="publish-successful-using-promises" title="Publish successful using Promises" class="title-red" id="publish-successful-using-promises">Publish successful using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {timetoken: "14920301569575101"}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">err</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">err</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-by-network-down-using-promises" data-id="publish-unsuccessful-by-network-down-using-promises" title="Publish unsuccessful by network down using Promises" class="title-red" id="publish-unsuccessful-by-network-down-using-promises">Publish unsuccessful by network down using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">err</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">err</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {error: true, operation: "PNPublishOperation", errorData: Error, category: "PNNetworkIssuesCategory"}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-without-publishkey-using-promises" data-id="publish-unsuccessful-without-publishkey-using-promises" title="Publish unsuccessful by initialization without publishKey using Promises" class="title-red" id="publish-unsuccessful-without-publishkey-using-promises">Publish unsuccessful by initialization without publishKey using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">err</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">err</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {error: true, operation: "PNPublishOperation", statusCode: 400, errorData: Error, category: "PNBadRequestCategory"}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-by-missing-channel-using-promises" data-id="publish-unsuccessful-by-missing-channel-using-promises" title="Publish unsuccessful by missing channel using Promises" class="title-red" id="publish-unsuccessful-by-missing-channel-using-promises">Publish unsuccessful by missing channel using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello world!'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">err</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">err</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {message: "Missing Channel", type: "validationError", error: true}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link"><a href="#publish-unsuccessful-by-missing-message-using-promises" data-id="publish-unsuccessful-by-missing-message-using-promises" title="Publish unsuccessful by missing message using Promises" class="title-red" id="publish-unsuccessful-by-missing-message-using-promises">Publish unsuccessful by missing message using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'ch1'</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">err</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">err</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {message: "Missing Message", type: "validationError", error: true}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li></ol><h2 class="inpage-link tag-link main-placeholder">Fire</h2><h3 class="inpage-link tag-link">Description</h3><div>The fire endpoint allows the client to send a message to PubNub Functions Event Handlers. These messages will go directly to any Event Handlers registered on the channel that you fire to and will trigger their execution. The content of the fired request will be available for processing within the Event Handler. The message sent via <code>fire()</code> isn't replicated, and so won't be received by any subscribers to the channel. The message is also not stored in history.</div><h3 class="inpage-link tag-link">Method(s)</h3><div>To <code>Fire a message</code> you can use the following method(s) in the JavaScript V4 SDK:</div><ol class="ol-margin-extra"><li><div><code class="inpage-plink tag-link padding-left-0"> <a href="#fire-args-1" data-id="fire-args-1" title="Fire Argument" class="title-red" id="fire-args-1">fire(<br> <span class="margin-left-1">{Object <code>message</code>, String <code>channel</code>, Boolean <code>sendByPost</code>, Object <code>meta</code>},</span> <span class="margin-left-1">Function <code>callback</code></span> ) </a></code></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th>Parameter</th><th>Type</th><th>Required</th><th>Defaults</th><th>Description</th></tr></thead><tbody><tr><td>Operation Arguments</td><td> Hash</td><td> Yes</td><td></td><td>A hash of arguments.</td></tr><tr><td><code class="margin-left-1">message </code></td><td>Object</td><td>Yes</td><td></td><td>The <code>message</code> may be any valid JSON type including objects, arrays, strings, and numbers.</td></tr><tr><td><code class="margin-left-1"> channel </code></td><td>String</td><td> Yes</td><td></td><td>Specifies <code>channel</code> name to publish messages to.</td></tr><tr><td><code class="margin-left-1">sendByPost </code></td><td> Boolean</td><td> Optional</td><td><code>false</code></td><td>If <code>true</code> the messages sent via POST.</td></tr><tr><td><code class="margin-left-1">meta</code></td><td> Object</td><td> Optional</td><td></td><td>Publish extra <code>meta</code> with the request.</td></tr><tr><td><code> callback </code></td><td>Function</td><td>Optional</td><td></td><td>Executes on a successful/unsuccessful <code>publish</code>.</td></tr></tbody></table></div></li></ol><h3 class="inpage-link tag-link">Basic Usage</h3><h4>Fire a message to a channel:</h4>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span>
        <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token pn-variable pn-before-colon">such</span><span class="token operator">:</span> <span class="token string">'object'</span> 
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span><span class="token punctuation">,</span>
        <span class="token pn-variable pn-before-colon">sendByPost</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// true to send via post</span>
        <span class="token pn-variable pn-before-colon">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
            <span class="token string">"cool"</span><span class="token operator">:</span> <span class="token string">"meta"</span>
        <span class="token punctuation">}</span>   <span class="token comment">// fire extra meta with the request</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">status</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// handle error</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">status</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
            <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"message published w/ timetoken"</span><span class="token punctuation">,</span> <span class="token pn-variable">response</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h3 class="inpage-link tag-link">Other Examples</h3><ol class="ol-margin-extra"><li><div class="inpage-plink tag-link"><a href="#fire-basic-usage-using-promises" data-id="fire-basic-usage-using-promises" title="Basic usage using Promises" class="title-red" id="fire-basic-usage-using-promises">Basic usage using Promises</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token pn-variable pn-before-colon">such</span><span class="token operator">:</span> <span class="token string">'object'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'my_channel'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">sendByPost</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// true to send via post</span>
    <span class="token pn-variable pn-before-colon">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
        <span class="token string">"cool"</span><span class="token operator">:</span> <span class="token string">"meta"</span>
    <span class="token punctuation">}</span>   <span class="token comment">// fire extra meta with the request</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">response</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">response</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">error</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token pn-variable">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token pn-variable">error</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li></ol><h2 class="inpage-link tag-link main-placeholder">Signal</h2><h3 class="inpage-link tag-link">Description</h3><p>The <code>signal()</code> function is used to send a signal to all subscribers of a channel.</p><p>By default, signals are limited to a message payload size of <code>30</code> bytes. This limit applies only to the payload, and not to the URI or headers. If you require a larger payload size, please <a href="mailto:support@pubnub.com" title="contact support">contact support</a>.</p><h3 class="inpage-link tag-link">Method(s)</h3><div>To <code>Signal a message</code> you can use the following method(s) in the JavaScript V4 SDK:</div><ol class="ol-margin-extra"><li class="list-inline"><div> <code class="inpage-plink tag-link padding-left-0"> <a href="#signal-args-1" data-id="signal-args-1" title="Signal Argument" class="title-red" id="signal-args-1">signal(<br> <span class="margin-left-1">{String <code>message</code>, String <code>channel</code>},</span> <span class="margin-left-1">Function <code>callback</code></span> ) </a> </code></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th>Parameter</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>Operation Arguments</td><td> Hash</td><td> Yes</td><td>A hash of arguments.</td></tr><tr><td><code class="margin-left-1">message </code></td><td>String</td><td>Yes</td><td>The <code>message</code> may be any valid JSON type including objects, arrays, strings, and numbers.</td></tr><tr><td><code class="margin-left-1"> channel </code></td><td>String</td><td> Yes</td><td>Specifies <code>channel</code> name to send messages to.</td></tr><tr><td><code> callback </code></td><td>Function</td><td>Optional</td><td>Executes on a successful/unsuccessful <code>send</code>.</td></tr></tbody></table></div></li></ol><h3 class="inpage-link tag-link">Basic Usage</h3><h4>Signal a message to a channel:</h4>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">signal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">message</span><span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channel</span><span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h3 class="inpage-link tag-link">Response</h3>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">type</span> <span class="token pn-variable pn-before-equal">SignalResponse</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">timetoken</span><span class="token operator">:</span> <span class="token pn-variable">number</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h2 class="inpage-link tag-link main-placeholder">Subscribe</h2><h3 class="inpage-link tag-link">Description</h3><div>This function causes the client to create an open TCP socket to the PubNub Real-Time Network and begin listening for messages on a specified <code>channel</code>. To subscribe to a <code>channel</code> the client must send the appropriate <code>subscribeKey</code> at initialization.</div><div>By default a newly subscribed client will only receive messages published to the channel after the <code>subscribe()</code> call completes.</div><table class="table-icon-tip"><tbody><tr><td class="icon"><i class="fa icon icon-tip" title="tip">&nbsp;</i></td><td><div><p>You can be notified of connectivity via the listener, on establishing connection the <code>statusEvent.category</code> returns <code>PNConnectedCategory</code>.</p><p>By waiting for the connect event to return before attempting to publish, you can avoid a potential race condition on clients that subscribe and immediately publish messages before the <code>subscribe</code> has completed.</p></div></td></tr></tbody></table><table class="table-icon-warning"><tbody><tr><td class="icon"><i class="fa icon icon-warning" title="warning">&nbsp;</i></td><td><strong>Unsubscribing</strong> from all channels, and then <strong>subscribing</strong> to a new channel Y is not the same as subscribing to channel Y and then unsubscribing from the previously-subscribed channel(s). Unsubscribing from all channels resets the last-received <code>timetoken</code> and thus, there could be some gaps in the subscription that may lead to message loss.</td></tr></tbody></table><h3 class="inpage-link tag-link">Method(s)</h3><div>To <code>Subscribe to a channel</code> you can use the following method(s) in the JavaScript V4 SDK:</div><ol class="ol-margin-extra"><li class="list-inline"><div><code class="inpage-plink tag-link padding-left-0"><a href="#subscribe_args_1" data-id="subscribe_args_1" title="Subscribe Argument" class="title-red" id="subscribe_args_1">subscribe(<span class="margin-left-1">{Array <code>channels</code>, Array <code>channelGroups</code>, Boolean <code>withPresence</code>, Number <code>timetoken</code>}</span>)</a></code></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th>Parameter</th><th>Type</th><th>Required</th><th>Defaults</th><th>Description</th></tr></thead><tbody><tr><td>Operation Arguments</td><td> Hash</td><td> Yes</td><td></td><td>A hash of arguments.</td></tr><tr><td><code class="margin-left-1"> channels </code></td><td> Array</td><td>Yes</td><td></td><td>Specifies the <code>channels</code> to subscribe to. It is possible to specify multiple <code>channels</code> as a list or as an array.</td></tr><tr><td><code class="margin-left-1">channelGroups</code></td><td>Array</td><td>Specifying either <code>channels</code> or <code>channelGroups</code> is mandatory</td><td></td><td>Specifies the <code>channelGroups</code> to subscribe to.</td></tr><tr><td><code class="margin-left-1">withPresence </code></td><td> Boolean</td><td> Optional</td><td><code>false</code></td><td>If <code>true</code> it also subscribes to presence instances.</td></tr><tr><td><code class="margin-left-1">timetoken </code></td><td> Number</td><td> Optional</td><td></td><td>Specifies <code>timetoken</code> from which to start returning any available cached messages. Message retrieval with timetoken is not guaranteed and should only be considered a best-effort service.</td></tr></tbody></table></div></li></ol><h3 class="inpage-link tag-link">Basic Usage</h3><div>Subscribe to a channel:</div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<table class="table-icon-note"><tbody><tr><td class="icon"><i class="fa icon icon-note" title="note"></i></td><td><div>The response of the call is handled by adding a Listener. Please see the <a href="#listeners" title="Listeners section">Listeners section</a> for more details. Listeners should be added before calling the method.</div></td></tr></tbody></table><h3 class="inpage-link tag-link">Returns</h3><div class="inpage-plink tag-link"><a href="#subscribe-status-response" data-id="subscribe-status-response" title="Subscribe Status Response" class="title-red" id="subscribe-status-response">The following objects will be returned in the Status Response</a></div><table class="table table-striped od"><thead><tr><th>Object</th><th>Description</th></tr></thead><tbody><tr><td><code>category</code></td><td><code>PNConnectedCategory</code></td></tr><tr><td><code>operation</code></td><td><code>PNSubscribeOperation</code></td></tr><tr><td><code>affectedChannels</code></td><td>The channels affected in the operation, of type array.</td></tr><tr><td><code>subscribedChannels</code></td><td>All the current subscribed channels, of type array.</td></tr><tr><td><code>affectedChannelGroups</code></td><td>The channel groups affected in the operation, of type array.</td></tr><tr><td><code>lastTimetoken</code></td><td>The last timetoken used in the subscribe request, of type long.</td></tr><tr><td><code>currentTimetoken</code></td><td>The current timetoken fetched in the subscribe response, which is going to be used in the next request, of type long.</td></tr></tbody></table>

<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    category<span class="token operator">:</span> 'PNConnectedCategory'<span class="token punctuation">,</span>
    operation<span class="token operator">:</span> 'PNSubscribeOperation'<span class="token punctuation">,</span>
    affectedChannels<span class="token operator">:</span> <span class="token punctuation">[</span>'my_channel_1'<span class="token punctuation">]</span><span class="token punctuation">,</span>
    subscribedChannels<span class="token operator">:</span> <span class="token punctuation">[</span>'my_channel_1'<span class="token punctuation">]</span><span class="token punctuation">,</span>
    affectedChannelGroups<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    lastTimetoken<span class="token operator">:</span> '<span class="token number">14974492380756600</span>'<span class="token punctuation">,</span>
    currentTimetoken<span class="token operator">:</span> '<span class="token number">14974492384874375</span>'
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<div class="inpage-plink tag-link"><a href="#subscribe-message-response" data-id="subscribe-message-response" title="Subscribe Message Response" class="title-red" id="subscribe-message-response">The following objects will be returned in the Subscribe Message Response</a></div><table class="table table-striped od"><thead><tr><th>Object</th><th>Description</th></tr></thead><tbody><tr><td><code>channel</code></td><td>The <code>channel</code> for which the message belongs.</td></tr><tr><td><code>subscription</code></td><td>The <code>channel group</code> or wildcard subscription match (if exists).</td></tr><tr><td><code>timetoken</code></td><td>Publish <code>timetoken</code>.</td></tr><tr><td><code>message</code></td><td>The <code>payload</code>.</td></tr><tr><td><code><span class="strike">actualChannel</span></code></td><td>Deprecated. Use property <code>channel</code>.</td></tr><tr><td><code><span class="strike">subscribedChannel</span></code></td><td>Deprecated. Use property <code>subscription</code>.</td></tr></tbody></table>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    actualChannel<span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    channel<span class="token operator">:</span> <span class="token string">"my_channel_1"</span><span class="token punctuation">,</span>
    message<span class="token operator">:</span> <span class="token string">"Hello World!"</span><span class="token punctuation">,</span>
    publisher<span class="token operator">:</span> <span class="token string">"pn-58e1a647-3e8a-4c7f-bfa4-e007ea4b2073"</span><span class="token punctuation">,</span>
    subscribedChannel<span class="token operator">:</span> <span class="token string">"my_channel_1"</span><span class="token punctuation">,</span>
    subscription<span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    timetoken<span class="token operator">:</span> <span class="token string">"14966804541029440"</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<div class="inpage-plink tag-link"><a href="#subscribe-presence-response" data-id="subscribe-presence-response" title="Subscribe Presence Response" class="title-red" id="subscribe-presence-response">The following objects will be returned in the Presence Response</a></div><table class="table table-striped od"><thead><tr><th>Object</th><th>Description</th></tr></thead><tbody><tr><td><code>action</code></td><td>Can be <code>join</code>, <code>leave</code>, <code>state-change</code> or <code>timeout</code>.</td></tr><tr><td><code>channel</code></td><td>The <code>channel</code> for which the message belongs.</td></tr><tr><td><code>occupancy</code></td><td>No. of users connected with the <code>channel</code>.</td></tr><tr><td><code>state</code></td><td>User State.</td></tr><tr><td><code>subscription</code></td><td>The <code>channel group</code> or wildcard subscription match (if exists)</td></tr><tr><td><code>timestamp</code></td><td>Current <code>timetoken</code>.</td></tr><tr><td><code>timetoken</code></td><td>Publish <code>timetoken</code>.</td></tr><tr><td><code>uuid</code></td><td>UUIDs of users who are connected with the <code>channel</code>.</td></tr></tbody></table>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    category<span class="token operator">:</span> 'PNConnectedCategory'<span class="token punctuation">,</span>
    operation<span class="token operator">:</span> 'PNSubscribeOperation'<span class="token punctuation">,</span>
    affectedChannels<span class="token operator">:</span> <span class="token punctuation">[</span>'my_channel_1'<span class="token punctuation">]</span><span class="token punctuation">,</span>
    subscribedChannels<span class="token operator">:</span> <span class="token punctuation">[</span>'my_channel_1'<span class="token punctuation">]</span><span class="token punctuation">,</span>
    affectedChannelGroups<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    lastTimetoken<span class="token operator">:</span> '<span class="token number">14974492380756600</span>'<span class="token punctuation">,</span>
    currentTimetoken<span class="token operator">:</span> '<span class="token number">14974492384874375</span>'
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>


<h3 class="inpage-link tag-link">Other Examples</h3><ol class="ol-margin-extra"><li><div class="inpage-plink tag-link inline"><a href="#subscribe_example_2" data-id="subscribe_example_2" class="title-red" title="Subscribing to more than one channel" id="subscribe_example_2">Subscribing to more than one channel:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div><div>It is possible to subscribe to more than one channel&nbsp;over a single TCP socket by taking advantage of Multiplexing feature. See the Multiplexing section for more info on this feature as well as the examples below using a list or an array to specify&nbsp;channel name.</div><div class="inpage-link tag-link"><a href="#subscribe_example_2.2" data-id="subscribe_example_2.2" class="title-red" id="subscribe_example_2.2">Subscribing by specifying channel as an array:</a></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channel_1'</span><span class="token punctuation">,</span> <span class="token string">'my_channel_2'</span><span class="token punctuation">,</span> <span class="token string">'my_channel_3'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

</li><li><div class="inpage-plink tag-link inline"><a href="#subscribe_example_3" data-id="subscribe_example_3" class="title-red" title="Subscribing to a Presence channel" id="subscribe_example_3">Subscribing to a Presence channel:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Presence</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Presence add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div><div>For any given channel there is an associated Presence channel. You can subscribe directly to the channel by appending <code>-pnpres</code> to the channel name. For example the channel named <code>my_channel</code> would have the presence channel named <code>my_channel-pnpres</code>.</div>

<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token pn-variable pn-before-colon">withPresence</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h3 class="inpage-link tag-link">Sample Responses</h3><h4 class="inpage-link tag-link">Join Event</h4>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"channel"</span><span class="token operator">:</span> <span class="token string">"my_channel"</span><span class="token punctuation">,</span>
    <span class="token property">"subscription"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"actualChannel"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"subscribedChannel"</span><span class="token operator">:</span> <span class="token string">"my_channel-pnpres"</span><span class="token punctuation">,</span>
    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"join"</span><span class="token punctuation">,</span>
    <span class="token property">"timetoken"</span><span class="token operator">:</span> <span class="token string">"15119466699655811"</span><span class="token punctuation">,</span>
    <span class="token property">"occupancy"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"uuid"</span><span class="token operator">:</span> <span class="token string">"User1"</span><span class="token punctuation">,</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1511946669</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h4 class="inpage-link tag-link">Leave Event</h4>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"channel"</span><span class="token operator">:</span> <span class="token string">"my_channel"</span><span class="token punctuation">,</span>
    <span class="token property">"subscription"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"actualChannel"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"subscribedChannel"</span><span class="token operator">:</span> <span class="token string">"my_channel-pnpres"</span><span class="token punctuation">,</span>
    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"leave"</span><span class="token punctuation">,</span>
    <span class="token property">"timetoken"</span><span class="token operator">:</span> <span class="token string">"15119446002445794"</span><span class="token punctuation">,</span>
    <span class="token property">"occupancy"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"uuid"</span><span class="token operator">:</span> <span class="token string">"User1"</span><span class="token punctuation">,</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1511944600</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h4 class="inpage-link tag-link">Timeout Event</h4>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
   <span class="token property">"channel"</span><span class="token operator">:</span> <span class="token string">"my_channel"</span><span class="token punctuation">,</span>
   <span class="token property">"subscription"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
   <span class="token property">"actualChannel"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
   <span class="token property">"subscribedChannel"</span><span class="token operator">:</span> <span class="token string">"my_channel-pnpres"</span><span class="token punctuation">,</span>
   <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"timeout"</span><span class="token punctuation">,</span>
   <span class="token property">"timetoken"</span><span class="token operator">:</span> <span class="token string">"15119519897494311"</span><span class="token punctuation">,</span>
   <span class="token property">"occupancy"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
   <span class="token property">"uuid"</span><span class="token operator">:</span> <span class="token string">"User2"</span><span class="token punctuation">,</span>
   <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1511951989</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h4 class="inpage-link tag-link">Custom Presence Event (State Change)</h4>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"channel"</span><span class="token operator">:</span> <span class="token string">"my_channel"</span><span class="token punctuation">,</span>
    <span class="token property">"subscription"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"actualChannel"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"subscribedChannel"</span><span class="token operator">:</span> <span class="token string">"my_channel-pnpres"</span><span class="token punctuation">,</span>
    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"state-change"</span><span class="token punctuation">,</span>
    <span class="token property">"state"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"isTyping"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"timetoken"</span><span class="token operator">:</span> <span class="token string">"15119477895378127"</span><span class="token punctuation">,</span>
    <span class="token property">"occupancy"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"uuid"</span><span class="token operator">:</span> <span class="token string">"User4"</span><span class="token punctuation">,</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1511947789</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h4 class="inpage-link tag-link">Interval Event</h4>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"interval"</span><span class="token punctuation">,</span>
    <span class="token property">"occupancy"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1511947739</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<div><p>When a channel is in interval mode with <code>presence_deltas</code> <code>pnconfig</code> flag enabled, the interval message may also include the following fields which contain an array of changed UUIDs since the last interval message.</p><ul><li>joined</li><li>left</li><li>timedout</li></ul><p>For example, this interval message indicates there were 2 new UUIDs that joined and 1 timed out UUID since the last interval:</p>

    <div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"action"</span><span class="token operator">:</span><span class="token string">"interval"</span><span class="token punctuation">,</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span><span class="token number">1548340678</span><span class="token punctuation">,</span>
    <span class="token property">"occupancy"</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"join"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"pn-94bea6d1-2a9e-48d8-9758-f1b7162631ed"</span><span class="token punctuation">,</span><span class="token string">"pn-cecbfbe3-312f-4928-93a2-5a79c91b10e0"</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"timedout"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"pn-cecbfbe3-312f-4928-93a2-5a79c91b10e0"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"b"</span><span class="token operator">:</span><span class="token string">"my-channel-pnpres"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

    <p>If the full interval message is greater than <code>30KB</code> (since the max publish payload is <code>32KB</code>), none of the extra fields will be present. Instead there will be a <code>here_now_refresh</code> boolean field set to <code>true</code>. This indicates to the user that they should do a <code>hereNow</code> request to get the complete list of users present in the channel.</p>

    <div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"channel"</span><span class="token operator">:</span> <span class="token string">"my_channel"</span><span class="token punctuation">,</span>
    <span class="token property">"subscription"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"actualChannel"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"subscribedChannel"</span><span class="token operator">:</span> <span class="token string">"my_channel-pnpres"</span><span class="token punctuation">,</span>
    <span class="token property">"action"</span><span class="token operator">:</span> <span class="token string">"interval"</span><span class="token punctuation">,</span>
    <span class="token property">"timetoken"</span><span class="token operator">:</span> <span class="token string">"15119477396210903"</span><span class="token punctuation">,</span>
    <span class="token property">"occupancy"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1511947739</span><span class="token punctuation">,</span>
    <span class="token property">"here_now_refresh"</span> <span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</div></li><li><div class="inpage-plink tag-link inline"><a href="#subscribe_example_wildcard" data-id="subscribe_example_wildcard" class="title-red" title="Wildcard subscribe to channels" id="subscribe_example_wildcard">Wildcard subscribe to channels:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled with Enable Wildcard Subscribe checked for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div><div>Wildcard subscribes allow the client to subscribe to multiple channels using wildcard. E.g., if you subscribe to <code>a.*</code> you will get all messages for <code>a.b</code>, <code>a.c</code>, <code>a.x</code>. The wildcarded <code>*</code> portion refers to any portion of the channel string name after the <code>dot (.)</code>.</div><table class="table-icon-note"><tbody><tr><td class="icon"><i class="fa icon icon-note" title="note">&nbsp;</i></td><td><div>3 levels (2 dots) of wildcarding is supported, e.g.: <br><code>a.*</code> <br><code>a.b.*</code></div></td></tr></tbody></table>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ab.*'</span><span class="token punctuation">]</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link inline"><a href="#subscribe_example_with_state" data-id="subscribe_example_with_state" class="title-red" title="Subscribing with State" id="subscribe_example_with_state">Subscribing with State:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Presence</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Presence add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div><table class="table-icon-note"><tbody><tr><td class="icon"><i class="fa icon icon-note" title="note">&nbsp;</i></td><td>Always set the <code>UUID</code> to uniquely identify the user or device that connects to PubNub. This <code>UUID</code> should be persisted, and should remain unchanged for the lifetime of the user or the device. Not setting the <code>UUID</code> can significantly impact your billing if your account uses the <a href="/pricing/#pn-chat" title="Pricing">Monthly Active Users (MAUs)</a> based pricing model, and can also lead to unexpected behavior if you have Presence enabled.</td></tr></tbody></table>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword keyword-var">var</span> <span class="token pn-variable pn-before-equal">pubnub</span> <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token pn-variable">PubNub</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
	<span class="token comment">/* initiation arguments */</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token function-variable function">status</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">statusEvent</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token pn-variable">statusEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-before-equal pn-after-dot">category</span> <span class="token operator">===</span> <span class="token string">"PNConnectedCategory"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword keyword-var">var</span> <span class="token pn-variable pn-before-equal">newState</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
				<span class="token keyword keyword-new">new</span><span class="token operator">:</span> <span class="token string">'state'</span> 
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>
				<span class="token punctuation">{</span> 
					<span class="token pn-variable pn-before-colon">state</span><span class="token operator">:</span> <span class="token pn-variable">newState</span> 
				<span class="token punctuation">}</span><span class="token punctuation">,</span> 
				<span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">status</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// handle state setting response</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function-variable function">message</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">message</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// handle message</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function-variable function">presence</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">presenceEvent</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// handle presence</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
	<span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ch1'</span><span class="token punctuation">,</span> <span class="token string">'ch2'</span><span class="token punctuation">,</span> <span class="token string">'ch3'</span><span class="token punctuation">]</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink inline"><a href="#subscribe-example-with-channel-group" data-id="subscribe-example-with-channel-group" class="title-red" title="Subscribe to a channel group" id="subscribe-example-with-channel-group">Subscribe to a <span class="text-lowercase"><code>channel group</code></span>:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token pn-variable pn-before-colon">channelGroups</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channelGroup'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink inline"><a href="#subscribe-example-with-presence-channel-group" data-id="subscribe-example-with-presence-channel-group" class="title-red" title="Subscribe to the presence channel of a channel group" id="subscribe-example-with-presence-channel-group">Subscribe to the presence channel of a <span class="text-lowercase"><code>channel group</code></span>:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller and Presence</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that both Stream Controller and Presence add-ons are enabled for your key. See this page on enabling add-on features on your keys: <br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channelGroups</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'family'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">withPresence</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div></li><li><div class="inpage-plink inline"><a href="#subscribe-multiple-channel-groups" data-id="subscribe-multiple-channel-groups" class="title-red" title="Subscribing to more than one channel group" id="subscribe-multiple-channel-groups">Subscribing to more than one <span class="text-lowercase"><code>channel group</code></span>:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channelGroups</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channelGroup1'</span><span class="token punctuation">,</span> <span class="token string">'my_channelGroup2'</span><span class="token punctuation">,</span> <span class="token string">'my_channelGroup3'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink inline"><a href="#subscribe-channel-and-channel-group" data-id="subscribe-channel-and-channel-group" class="title-red" title="Subscribe to a channel group" id="subscribe-channel-and-channel-group">Subscribing to a <span class="text-lowercase"><code>channel</code></span> and <span class="text-lowercase"><code>channel group</code></span> simultaneously:</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token pn-variable pn-before-colon">channelGroups</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channelGroup'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li></ol><h2 class="inpage-link tag-link main-placeholder">Unsubscribe</h2><h3 class="inpage-link tag-link">Description</h3><div>When subscribed to a single channel, this function causes the client to issue a <code>leave</code> from the <code>channel</code> and close any open socket to the PubNub Network. For multiplexed channels, the specified <code>channel</code>(s) will be removed and the socket remains open until there are no more channels remaining in the list.<table class="table-icon-warning"><tbody><tr><td class="icon"><i class="fa icon icon-warning" title="warning">&nbsp;</i></td><td><strong>Unsubscribing</strong> from all channels, and then <strong>subscribing</strong> to a new channel Y is not the same as subscribing to channel Y and then unsubscribing from the previously-subscribed channel(s). Unsubscribing from all channels resets the last-received <code>timetoken</code> and thus, there could be some gaps in the subscription that may lead to message loss.</td></tr></tbody></table></div><h3 class="inpage-link tag-link">Method(s)</h3><div>To <code>Unsubscribe from a channel</code> you can use the following method(s) in the JavaScript V4 SDK:</div><ol class="ol-margin-extra"><li class="list-inline"><div><code class="inpage-plink tag-link padding-left-0"><a href="#unsubscribe_args_1" data-id="unsubscribe_args_1" class="title-red" id="unsubscribe_args_1">unsubscribe(<span class="margin-left-1">{Array <code>channels</code>, Array <code>channelGroups</code>}</span>) </a></code></div><div class="table-responsive"><table class="table table-striped"><thead><tr><th>Parameter</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>Operation Arguments</td><td>Hash</td><td>Yes</td><td>A hash of arguments.</td></tr><tr><td><code class="margin-left-1">channels</code></td><td>Array</td><td> Yes</td><td>Specifies the <code>channel</code> to unsubscribe from.</td></tr><tr><td><code class="margin-left-1">channelGroups </code></td><td>Array</td><td>Specifying either <code>channels</code> or <code>channelGroups</code> is mandatory</td><td>Specifies the <code>channelGroups</code> to unsubscribe from.</td></tr></tbody></table></div></li><li class="no-space"></li></ol><h3 class="inpage-link tag-link">Basic Usage</h3><div class="title-red">Unsubscribe from a channel:</div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'my_channel'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h3 class="inpage-link tag-link">Response</h3><div>The output below demonstrates the response to a successful call:</div>
<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
	<span class="token property">"action"</span> <span class="token operator">:</span> <span class="token string">"leave"</span>
<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<h3 class="inpage-link tag-link">Other Examples</h3><ol class="ol-margin-extra"><li><div class="inpage-plink tag-link inline"><a href="#unsubscribe_example_1" data-id="unsubscribe_example_1" class="title-red" title="Unsubscribing from multiple channels" id="unsubscribe_example_1">Unsubscribing from multiple channels.</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div>

<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token pn-variable pn-before-colon">channels</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'chan1'</span><span class="token punctuation">,</span> <span class="token string">'chan2'</span><span class="token punctuation">,</span> <span class="token string">'chan3'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<div class="inpage-plink"><a href="#unsubscribe_example_1_response" data-id="unsubscribe_example_1_response" class="title-red" id="unsubscribe_example_1_response">Example Response:</a></div>

<div class="code-toolbar"><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
	<span class="token property">"action"</span> <span class="token operator">:</span> <span class="token string">"leave"</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
</li><li><div class="inpage-plink tag-link inline"><a href="#unsubscribe_example_3" data-id="unsubscribe_example_3" class="title-red" id="unsubscribe_example_3">Unsubscribing from multiple channel groups.</a></div><div class="custom-popup-main"><span class="popup-button">Requires <i>Stream Controller</i> add-on</span><span class="popup-content"> <a title="Close" href="javascript:void(0)" class="custom-popup-close">X</a><span class="inner-content">Requires that the Stream Controller add-on is enabled for your key. See this page on enabling add-on features on your keys:<br><br><a href="/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys" target="_blank" title="Open in New window">http://www.pubnub.com/knowledge-base/discussion/644/how-do-i-enable-add-on-features-for-my-keys</a>.</span></span></div>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">unsubscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token pn-variable pn-before-colon">channelGroups</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'demo_group1'</span><span class="token punctuation">,</span> <span class="token string">'demo_group2'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

</li></ol><h2 class="inpage-link tag-link main-placeholder">Unsubscribe All</h2><h3 class="inpage-link tag-link">Description</h3><div>Unsubscribe from all channels and all channel groups</div><h3 class="inpage-link tag-link">Method(s)</h3><ul><li class="list-inline"><code>unsubscribeAll()</code></li></ul><h3 class="inpage-link tag-link">Basic Usage</h3>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">unsubscribeAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>

<h3 class="inpage-link tag-link">Returns</h3>None<h2 class="inpage-link tag-link main-placeholder">Listeners</h2><h3 class="inpage-link tag-link">Description</h3><div><p>You can be notified of connectivity status, message and presence notifications via the listeners.</p><p>Listeners should be added before calling the method.</p></div><h4 class="inpage-link tag-link">Adding Listeners</h4>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// Messages</span>
  <span class="token function-variable function">message</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">m</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelName</span> <span class="token operator">=</span> <span class="token pn-variable">m</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">channel</span><span class="token punctuation">;</span> <span class="token comment">// Channel on which the message was published</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelGroup</span> <span class="token operator">=</span> <span class="token pn-variable">m</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">subscription</span><span class="token punctuation">;</span> <span class="token comment">// Channel group or wildcard subscription match (if exists)</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">pubTT</span> <span class="token operator">=</span> <span class="token pn-variable">m</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">;</span> <span class="token comment">// Publish timetoken</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">msg</span> <span class="token operator">=</span> <span class="token pn-variable">m</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">;</span> <span class="token comment">// Message payload</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">publisher</span> <span class="token operator">=</span> <span class="token pn-variable">m</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">publisher</span><span class="token punctuation">;</span> <span class="token comment">// Message publisher</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// Presence</span>
  <span class="token function-variable function">presence</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">p</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">action</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">action</span><span class="token punctuation">;</span> <span class="token comment">// Can be join, leave, state-change, or timeout</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelName</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">channel</span><span class="token punctuation">;</span> <span class="token comment">// Channel to which the message belongs</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">occupancy</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">occupancy</span><span class="token punctuation">;</span> <span class="token comment">// Number of users subscribed to the channel</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">state</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">state</span><span class="token punctuation">;</span> <span class="token comment">// User state</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelGroup</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">subscription</span><span class="token punctuation">;</span> <span class="token comment">//  Channel group or wildcard subscription match, if any</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">publishTime</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timestamp</span><span class="token punctuation">;</span> <span class="token comment">// Publish timetoken</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">timetoken</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">;</span> <span class="token comment">// Current timetoken</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">uuid</span> <span class="token operator">=</span> <span class="token pn-variable">p</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">uuid</span><span class="token punctuation">;</span> <span class="token comment">// UUIDs of users who are subscribed to the channel</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// Signals</span>
  <span class="token function-variable function">signal</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">s</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelName</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">channel</span><span class="token punctuation">;</span> <span class="token comment">// Channel to which the signal belongs</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelGroup</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">subscription</span><span class="token punctuation">;</span> <span class="token comment">// Channel group or wildcard subscription match, if any</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">pubTT</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">;</span> <span class="token comment">// Publish timetoken</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">msg</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">;</span> <span class="token comment">// Payload</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">publisher</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">publisher</span><span class="token punctuation">;</span> <span class="token comment">// Message publisher</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">objects</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter pn-before-equal-greater"><span class="token pn-variable">objectEvent</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channel</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">channel</span><span class="token punctuation">;</span> <span class="token comment">// Channel to which the event belongs</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelGroup</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">subscription</span><span class="token punctuation">;</span> <span class="token comment">// Channel group</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">timetoken</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">;</span> <span class="token comment">// Event timetoken</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">publisher</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">publisher</span><span class="token punctuation">;</span> <span class="token comment">// UUID that made the call</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">event</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">event</span><span class="token punctuation">;</span> <span class="token comment">// Name of the event that occurred</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">type</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">type</span><span class="token punctuation">;</span> <span class="token comment">// Type of the event that occurred</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">data</span> <span class="token operator">=</span> <span class="token pn-variable">objectEvent</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">data</span><span class="token punctuation">;</span> <span class="token comment">// Data from the event that occurred</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">messageAction</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">ma</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle message action</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelName</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">channel</span><span class="token punctuation">;</span> <span class="token comment">// Channel to which the message belongs</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">publisher</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">publisher</span><span class="token punctuation">;</span> <span class="token comment">// Message publisher</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">event</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">event</span><span class="token punctuation">;</span> <span class="token comment">// Message action added or removed</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">type</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">data</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">type</span><span class="token punctuation">;</span> <span class="token comment">// Message action type</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">value</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">data</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">value</span><span class="token punctuation">;</span> <span class="token comment">// Message action value</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">messageTimetoken</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">data</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">messageTimetoken</span><span class="token punctuation">;</span> <span class="token comment">// Timetoken of the original message</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">actionTimetoken</span> <span class="token operator">=</span> <span class="token pn-variable">ma</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">data</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">actionTimetoken</span><span class="token punctuation">;</span> <span class="token comment">// Timetoken of the message action</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">file</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">event</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelName</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">channel</span><span class="token punctuation">;</span> <span class="token comment">// Channel to which the file belongs</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">channelGroup</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">subscription</span><span class="token punctuation">;</span> <span class="token comment">// Channel group or wildcard subscription match (if exists)</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">publisher</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">publisher</span><span class="token punctuation">;</span> <span class="token comment">// File publisher</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">timetoken</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">timetoken</span><span class="token punctuation">;</span> <span class="token comment">// Event timetoken</span>

    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">message</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">message</span><span class="token punctuation">;</span> <span class="token comment">// Optional message attached to the file</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">fileId</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">file</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">id</span><span class="token punctuation">;</span> <span class="token comment">// File unique id</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">fileName</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">file</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">name</span><span class="token punctuation">;</span><span class="token comment">// File name</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">fileUrl</span> <span class="token operator">=</span> <span class="token pn-variable">event</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">file</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">url</span><span class="token punctuation">;</span> <span class="token comment">// File direct URL</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">status</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token pn-variable">s</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">affectedChannelGroups</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">affectedChannelGroups</span><span class="token punctuation">;</span> <span class="token comment">// Array of channel groups affected in the operation</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">affectedChannels</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">affectedChannels</span><span class="token punctuation">;</span> <span class="token comment">// Array of channels affected in the operation</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">category</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">category</span><span class="token punctuation">;</span> <span class="token comment">// Returns PNConnectedCategory</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">operation</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">operation</span><span class="token punctuation">;</span> <span class="token comment">// Returns PNSubscribeOperation</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">lastTimetoken</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">lastTimetoken</span><span class="token punctuation">;</span> <span class="token comment">// Last timetoken used in the subscribe request (type long)</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">currentTimetoken</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">currentTimetoken</span><span class="token punctuation">;</span> <span class="token comment">/* Current timetoken fetched in subscribe response,
                                                * to be used in the next request (type long) */</span>
    <span class="token keyword keyword-const">const</span> <span class="token pn-variable pn-before-equal">subscribedChannels</span> <span class="token operator">=</span> <span class="token pn-variable">s</span><span class="token punctuation">.</span><span class="token pn-variable pn-after-dot">subscribedChannels</span><span class="token punctuation">;</span> <span class="token comment">// Array of all currently subscribed channels</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<h4 class="inpage-link tag-link">Removing Listeners</h4>
<div class="code-toolbar"><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword keyword-var">var</span> <span class="token pn-variable pn-before-equal">existingListener</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">message</span><span class="token operator">:</span> <span class="token keyword keyword-function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token pn-variable">pubnub</span><span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token pn-variable">existingListener</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button>Copy</button></div></div></div>
<h4 class="inpage-link tag-link">Listener status events</h4><div class="table-responsive"><table class="table table-striped cd"><thead><tr><th>Categories</th><th>Description</th></tr></thead><tbody></tbody><tbody><tr><td><code>PN<wbr>NetworkUp<wbr>Category</code></td><td>The SDK detected that the network is online.</td></tr><tr><td><code>PN<wbr>NetworkDown<wbr>Category</code></td><td>The SDK announces this when a connection isn't available, or when the SDK isn't able to reach the PubNub Data Stream Network.</td></tr><tr><td><code>PN<wbr>Network<wbr>Issues<wbr>Category</code></td><td>A subscribe event experienced an exception when running. <br> The SDK isn't able to reach the PubNub Data Stream Network. <br> This may be due to many reasons, such as: the machine or device isn't connected to the internet; the internet connection has been lost; your internet service provider is having trouble; or, perhaps the SDK is behind a proxy.</td></tr><tr><td><code>PN<wbr>Reconnected<wbr>Category</code></td><td>The SDK was able to reconnect to PubNub.</td></tr><tr><td><code>PN<wbr>Connected<wbr>Category</code></td><td>SDK subscribed with a new mix of channels. <br> This is fired every time the channel or channel group mix changes.</td></tr><tr><td><code>PN<wbr>AccessDenied<wbr>Category</code></td><td>PAM permission failure.</td></tr><tr><td><code>PN<wbr>Malformed<wbr>Response<wbr>Category</code></td><td>JSON parsing crashed.</td></tr><tr><td><code>PN<wbr>BadRequest<wbr>Category</code></td><td>The server responded with a bad response error because the request is malformed.</td></tr><tr><td><code>PN<wbr>Decryption<wbr>Error<wbr>Category</code></td><td>If using decryption strategies and the decryption fails.</td></tr><tr><td><code>PNTimeout<wbr>Category</code></td><td>Failure to establish a connection to PubNub due to a timeout.</td></tr><tr><td><code>PNRequest<wbr>Message<wbr>CountExceed<wbr>Category</code></td><td>The SDK announces this error if <code>requestMessageCountThreshold</code> is set, and the number of messages received from PubNub (in-memory cache messages) exceeds the threshold.</td></tr><tr><td><code>PNUnknown<wbr>Category</code></td><td>Returned when the subscriber gets a non-200 HTTP response code from the server.</td></tr></tbody></table></div>